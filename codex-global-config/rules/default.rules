prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex --version"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "npm view @openai/codex version"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "where.exe gemini"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ErrorActionPreference='Stop'; Move-Item -LiteralPath 'C:\\Users\\16342\\Downloads\\s41467-025-65746-4 (2).pdf' -Destination 'C:\\Users\\16342\\Documents\\BaiduSyncdisk\\博士\\meta分析学习\\PFAS_Trophic_Magnification_Project\\PFAS_Trophic_Magnification\\' -Force"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -LiteralPath 'C:\\Users\\16342\\Documents\\BaiduSyncdisk\\博士\\meta分析学习\\PFAS_Trophic_Magnification_Project\\PFAS_Trophic_Magnification\\s41467-025-65746-4 (2).pdf' | Select-Object FullName,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ErrorActionPreference='Stop'; Get-ChildItem -Force $HOME\\.codex | Select-Object Name,FullName,Mode"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='C:\\Users\\16342\\.codex\\skills'; if(Test-Path $root){ Get-ChildItem -Path $root -Directory -Force | Select-Object Name,FullName; ''; '--- SKILL.md files ---'; Get-ChildItem -Path $root -Recurse -Filter SKILL.md -File -Force | Select-Object FullName } else { 'NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='C:\\Users\\16342'; Get-ChildItem -Path $root -Directory -Force | Where-Object { $_.Name -match 'claude|codex|cursor|agent|skill' } | Select-Object Name,FullName"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$candidates=@('C:\\Users\\16342\\.claude','C:\\Users\\16342\\.claude\\skills','C:\\Users\\16342\\AppData\\Roaming\\Claude','C:\\Users\\16342\\AppData\\Roaming\\Claude Code','C:\\Users\\16342\\.codex\\skills'); foreach($p in $candidates){ if(Test-Path $p){\"FOUND $p\"; Get-ChildItem -Path $p -Force | Select-Object -First 30 Name,Mode,FullName } else {\"MISS  $p\"} ; '' }"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$src='C:\\Users\\16342\\.claude\\skills'; $dst='C:\\Users\\16342\\.codex\\skills'; $valid=(Get-ChildItem -Path $src -Directory | Where-Object { Test-Path (Join-Path $_.FullName 'SKILL.md') }).Name; $existing=(Get-ChildItem -Path $dst -Directory -Force | Select-Object -ExpandProperty Name); 'VALID='+($valid -join ','); 'EXISTING='+($existing -join ','); $toCopy=$valid | Where-Object { $existing -notcontains $_ }; 'TO_COPY='+($toCopy -join ','); 'COUNT_VALID='+$valid.Count; 'COUNT_TO_COPY='+$toCopy.Count"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$src='C:\\Users\\16342\\.claude\\skills'; Get-ChildItem -Path $src -Directory | Where-Object { -not (Test-Path (Join-Path $_.FullName 'SKILL.md')) } | Select-Object Name,FullName"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$src='C:\\Users\\16342\\.claude\\skills'; Get-ChildItem -Path $src -Directory | ForEach-Object { $skill=$_; $m=Join-Path $skill.FullName 'SKILL.md'; [PSCustomObject]@{Name=$skill.Name; HasSkillMd=(Test-Path $m); SkillMdPath=$m} } | Sort-Object Name | Format-Table -AutoSize | Out-String -Width 220"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$src='C:\\Users\\16342\\.claude\\skills'; $dst='C:\\Users\\16342\\.codex\\skills'; $toCopy=(Get-ChildItem -Path $src -Directory | Where-Object { Test-Path (Join-Path $_.FullName 'SKILL.md') }); foreach($d in $toCopy){ Copy-Item -Path $d.FullName -Destination $dst -Recurse -Force }; 'COPIED='+$toCopy.Count"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='C:\\Users\\16342\\.codex\\skills'; Get-ChildItem -Path $root -Directory -Force | Select-Object Name | Sort-Object Name"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path 'C:\\Users\\16342\\.codex' -Force | Select-Object Name,Mode,FullName"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path 'C:\\Users\\16342\\.claude' -Force | Select-Object Name,Mode,FullName"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$paths=@('C:\\Users\\16342\\.claude\\config.json','C:\\Users\\16342\\.claude\\CLAUDE.md','C:\\Users\\16342\\.claude\\.mcp.json','C:\\Users\\16342\\Documents\\BaiduSyncdisk\\博士\\A2025论文\\光氮匹配综述论文\\光氮匹配综述论文\\.mcp.json','C:\\Users\\16342\\.codex\\config.json','C:\\Users\\16342\\.codex\\.mcp.json'); foreach($p in $paths){ if(Test-Path $p){\"FOUND $p\"} else {\"MISS  $p\"} }"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path 'C:\\Users\\16342\\.claude' -Recurse -Force -File -ErrorAction SilentlyContinue | Where-Object { $_.Name -match 'mcp|MCP' -or $_.Name -eq '.mcp.json' } | Select-Object -First 80 FullName,Name"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path 'C:\\Users\\16342\\.claude\\plugins' -Recurse -Force -File -ErrorAction SilentlyContinue | Where-Object { $_.Name -match 'config|settings|manifest|plugin|enabled|state' } | Select-Object -First 80 FullName,Name"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "claude mcp list"], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"claude mcp list\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"claude mcp --help\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"codex --version\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"codex --help\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"codex mcp list\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"codex mcp --help\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"codex mcp add --help\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"where.exe python\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"where.exe uv\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"python -m pip --version\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"python -m pip install --user git+https://github.com/54yyyu/zotero-mcp.git\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"& 'C:\\Users\\16342\\AppData\\Roaming\\Python\\Python314\\Scripts\\zotero-mcp.exe' --help\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"& 'C:\\Users\\16342\\AppData\\Roaming\\Python\\Python314\\Scripts\\zotero-mcp.exe' serve --help\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"codex mcp add zotero -- 'C:\\Users\\16342\\AppData\\Roaming\\Python\\Python314\\Scripts\\zotero-mcp.exe' serve --transport stdio\""], decision="allow")
prefix_rule(pattern=["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -Command \"codex mcp get zotero\""], decision="allow")
